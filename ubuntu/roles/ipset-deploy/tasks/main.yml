---
# This role deploys ipset rulesets to Ubuntu hosts

- name: Destroy any existing ipsets
  shell:
    cmd: /sbin/ipset destroy

- name: Copy ipset.service
  copy:
    src: ipset.service
    dest: /etc/systemd/system/ipset.service

- name: Enable ipset.service
  systemd:
    name: ipset
    enabled: yes
    daemon_reload: yes

- name: Copy ipset rulesets
  copy:
    src: "{{ ansible_fqdn }}.ipset"
    dest: /etc/ipset.conf

- name: Restart ipset
  systemd:
    name: ipset
    state: restarted
